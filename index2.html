<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">

      // Load the Visualization API and the controls package.
      google.load('visualization', '1.0', {'packages':['controls', 'corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(callData);

      var that = this;

      function callData() {
      	var queryChart = new google.visualization.Query('https://docs.google.com/a/tuxoo.eu/spreadsheet/ccc?key=1W3_v1-CgF6KZ3Vlfxt-EaOLFs5VgdgMRshmb9z8cSiI&sheet=chart2');
	 		queryChart.send(handleChartQueryResponse);
      }

      function handleChartQueryResponse(response) {
		  if (response.isError()) {
		    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
		    return;
		  }
	      var data = response.getDataTable();

 		   // Create a dashboard.
           var dashboard = new google.visualization.Dashboard(
           document.getElementById('dashboard_div'));

 		   var dateSelector = new google.visualization.ControlWrapper({
	          'controlType': 'CategoryFilter',
    	      'containerId': 'datefilter_div',
        	  'options': {
            	'filterColumnLabel': 'Datum',
            	'ui' : {
            		'allowNone' : false,
            		'allowMultiple' : false
            	}
          	  }
           });

           var categoryfilter = new google.visualization.ControlWrapper({
	          'controlType': 'CategoryFilter',
    	      'containerId': 'categoryfilter_div',
        	  'options': {
            	'filterColumnLabel': 'Category',
            	'ui' : {
            	}
          	  }
           });

           that.bubbleChart = new google.visualization.ChartWrapper({
          	'chartType': 'BubbleChart',
          	'containerId': 'chart_div',
          	'options': {
          		'height' : 600,
          		'width' : 600,
          		'animation' : {
            		'duration' : 1000,
            		'easing' : 'inAndOut'
            	},
            	'legend' :{
            		'position' : 'top' 
            	},
            	'chartArea' : {
            		'width' : '90%',
            		'height' : '90%'
            	},           	
            	'hAxis' : {
            		'baselineColor':'#ffffff',
            		'title': 'Opponent <-> Supporter',  
            		'titleTextStyle': {color: '#000000'},
            		'ticks':  [-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6],
            		'format': '#',
            		'gridlines': {
            			'color' : '#FFFFFF'
            		}
            	},
            	'vAxis' : {
            		'title': ' less <- Influence -> more',  
            		'titleTextStyle': {color: '#000000'},
            		'ticks':  [0, 1, 2, 3, 4, 5,6],
            		'format': '#',
            		'gridlines': {
            			'color' : '#FFFFFF'
            		}	
            	}
          	}
           });

           dashboard.bind(new Array(dateSelector, categoryfilter), that.bubbleChart);
		   dashboard.draw(data);

		   google.visualization.events.addListener(that.bubbleChart, 'select', func);

		};

	   function func() {
    		console.log('Hoppla' + that.bubbleChart.getChart().getSelection()[0]);

		} 


    </script>
  </head>

  <body>
    <!--Div that will hold the dashboard-->
    <div id="dashboard_div">
      <!--Divs that will hold each control and chart-->
      <div id="datefilter_div"></div>
      <div id="categoryfilter_div"></div>
      <div id="chart_div"></div>
    </div>
  </body>
</html>